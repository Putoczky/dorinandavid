---
interface Props {
	class?: string;
	svgFile?: string;
}

const { class: className = '', svgFile = 'dom.svg' } = Astro.props;
---

<div class={`flex justify-center ${className}`} data-svg-container data-svg-file={svgFile}>
	<!-- SVG will be loaded here -->
</div>

<script>
	async function loadSVG(container: HTMLElement) {
		if (!container) return;

		const svgFile = container.getAttribute('data-svg-file') || 'dom.svg';

		try {
			const response = await fetch(`/${svgFile}`);
			const svgText = await response.text();
			
			const tempDiv = document.createElement('div');
			tempDiv.innerHTML = svgText;
			
			const svg = tempDiv.querySelector('svg');
			
			if (!svg) {
				console.error('SVG element not found');
				return;
			}

			container.innerHTML = '';
			container.appendChild(svg);
		} catch (error) {
			console.error('Error loading SVG:', error);
		}
	}

	function initAllSVGs() {
		const containers = document.querySelectorAll<HTMLElement>('[data-svg-container]');
		containers.forEach((container) => {
			loadSVG(container);
		});
	}

	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initAllSVGs);
	} else {
		initAllSVGs();
	}
</script>

<style>
	[data-svg-container] svg {
		display: block;
		width: 100%;
		height: 100%;
	}
</style>

